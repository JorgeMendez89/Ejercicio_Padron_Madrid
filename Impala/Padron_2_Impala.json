[
{
  "pk": 395, 
  "model": "desktop.document2", 
  "fields": {
    "search": "select count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\nfrom padron_particionada\nwhere desc_distrito in (\"CENTRO\", \"LATINA\", \"CHAMARTIN\", \"TETUAN\", \"VICALVARO\", \"BARAJAS\")\ngroup by desc_distrito, desc_barrio\norder by desc_distrito, desc_barrio", 
    "uuid": "c82223f2-b6aa-7cac-1958-f6b288712836", 
    "extra": "", 
    "type": "query-impala", 
    "description": "", 
    "is_history": false, 
    "parent_directory": [
      "45b4c7b4-4b05-4cd9-ba3f-e0d3549a8aa4", 
      1, 
      false
    ], 
    "is_managed": false, 
    "last_modified": "2021-05-18T00:28:46", 
    "version": 1, 
    "owner": [
      "cloudera"
    ], 
    "dependencies": [], 
    "data": "{\"loadingHistory\": false, \"schedulerViewModel\": null, \"retryModalCancel\": null, \"schedulerViewModelIsLoaded\": false, \"historyTotalPages\": 1, \"id\": 395, \"snippets\": [{\"wasBatchExecuted\": false, \"chartLimits\": [5, 10, 25, 50, 100], \"associatedDocumentLoading\": true, \"isReady\": true, \"statement_raw\": \"-- 3. Juguemos con Impala.\\n-- 3.1. \\u00bfQu\\u00e9 es Impala?\\n/* \\nEs un motor SQL de elevado performance pensada para operar sobre grandes vol\\u00famenes de datos.\\nEl motor es MPP: procesamiento masivo en paralelo\\nCon latencias de Milisegundos.\\n\\nImpala corre sobre clusters Hadoop.\\nPuede ejecutar Queries sobre HDFS o Hbase.\\nLee y escribe datos sobre ficheros con tipos de datos t\\u00edpicos de Hadoop.\\nOriginalmente desarrollada por Cloudera.\\nHoy en d\\u00eda es un proyecto perteneciente al ASF (Apache Software Foundation)\\nEs 100% open source.\\nTodav\\u00eda est\\u00e1 en proceso de incubaci\\u00f3n.\\n*/\\n\\n-- 3.2. \\u00bfEn qu\\u00e9 se diferencia de Hive?\\n/*\\nImpala ejecuta las queriesdirectamente sobre el clusteren lugar de ejecutar MapReducepara procesar.\\nEs en torno a unas 5 veces m\\u00e1s r\\u00e1pido que Hiveo Pig, aunque  a menudo puede ser hasta 20 veces m\\u00e1s r\\u00e1pido.\\nActualmente hay una serie de funcionalidades que Impala no soporta pero Hive s\\u00ed\\n- Ficheros con tipos de datos a medida.\\n- El tipo de datos DATE.\\n- Funciones XML y JSON.\\n- Algunas funciones de agregaci\\u00f3n como: \\u201ccovar_pop, covar_samp, corr, percentile, percentile_approx, histogram_numeric, collect_set\\u201d\\n- Sampling(que es el ejecutar queries sobre un subset de una tabla en lugar de sobre toda la tabla).\\n- Vistas laterales (sobre una columna de una tabla, fila a fila, se le aplica una funci\\u00f3n (que crea un resultado en forma de \\nvista en ejecuci\\u00f3n) y sobre ese resultado se aplica otra funci\\u00f3n, que es lo que se muestra.\\n- Multilples cl\\u00e1usulas DISTINCT por query.\\n- UDFs(soportadas a partir de impala  1.2).\\n\\n*/\\n\\n--3.3. Comando INVALIDATE METADATA, \\u00bfen qu\\u00e9 consiste?\\n/*\\nMarca los metadatos de una o todas las tablas como obsoletos. \\nRequerido despu\\u00e9s de que se crea una tabla a trav\\u00e9s del shell de Hive, \\nantes de que la tabla est\\u00e9 disponible para consultas de Impala. \\nLa pr\\u00f3xima vez que el nodo actual de Impala realiza una consulta en una tabla \\ncuyos metadatos est\\u00e1n invalidados, Impala vuelve a cargar los metadatos asociados \\nantes de que contin\\u00fae la consulta. \\nEsta es una operaci\\u00f3n relativamente costosa en comparaci\\u00f3n con la actualizaci\\u00f3n incremental \\nde metadatos realizada por la instrucci\\u00f3n REFRESH, por lo que en el escenario com\\u00fan de agregar \\nnuevos archivos de datos a una tabla existente, prefiera REFRESH en lugar de INVALIDATE METADATA. \\n*/\\n\\n-- 3.4. Hacer invalidate metadata en Impala de la base de datos datos_padron.\\nuse datos_padron;\\nINVALIDATE METADATA;\\n\\n-- 3.5. Calcular el total de EspanolesHombres, espanolesMujeres, ExtranjerosHombres y ExtranjerosMujeres \\n-- agrupado por DESC_DISTRITO y DESC_BARRIO.\\n\\nselect sum(espanoleshombres) total_hombres_espa\\u00f1oles, sum(espanolesmujeres) total_mujeres_espa\\u00f1olas, sum(extranjeroshombres) total_hombres_extranjeros, sum(extranjerosmujeres) total_mujeres_extranjeras, desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n-- 3.6. Llevar a cabo las consultas en Hive en las tablas padron_txt_2 y padron_parquet_2\\n-- (No deber\\u00edan incluir espacios innecesarios). \\u00bfAlguna conclusi\\u00f3n?\\n\\n-- el tiempo de respuesta es mucho mayor en hive que en impala, ademas de que hive no reconoce la \\u00f1 en un nombre de columna\\n\\n\\n-- 3.7. Llevar a cabo la misma consulta sobre las mismas tablas en Impala. \\u00bfAlgunaconclusi\\u00f3n?\\nselect sum(espanoleshombres) total_hombres_espanoles, sum(espanolesmujeres) total_mujeres_espanolas, sum(extranjeroshombres) total_hombres_extranjeros, sum(extranjerosmujeres) total_mujeres_extranjeras, desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect sum(espanoleshombres) total_hombres_espanoles, sum(espanolesmujeres) total_mujeres_espanolas, sum(extranjeroshombres) total_hombres_extranjeros, sum(extranjerosmujeres) total_mujeres_extranjeras, desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n-- La velocidad de respuesta es mejor en impala para las dos consultas, por lo tanto se traduce como mejor rendimiento.\\n\\n-- 4.3. Hacer invalidate metadata en Impala de la base de datos padron_particionado.\\n\\ninvalidate metadata datos_padron.padron_particionada;\\n\\n-- 4.4.Calcular el total de EspanolesHombres, EspanolesMujeres, ExtranjerosHombres y ExtranjerosMujeres agrupado por \\n-- DESC_DISTRITO y DESC_BARRIO para los distritos CENTRO, LATINA, CHAMARTIN, TETUAN, VICALVARO y BARAJAS.\\n\\nselect * from padron_particionada;\\n\\nselect sum(espanoleshombres) total_hombres_espanoles, sum(espanolesmujeres) total_mujeres_espanolas, sum(extranjeroshombres) total_hombres_extranjeros, sum(extranjerosmujeres) total_mujeres_extranjeras, desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n-- 4.6. Llevar a cabo la consulta en Impala en las tablas padron_parquet y padron_particionado. \\u00bfAlguna conclusi\\u00f3n?\\nselect sum(espanoleshombres) total_hombres_espanoles, sum(espanolesmujeres) total_mujeres_espanolas, sum(extranjeroshombres) total_hombres_extranjeros, sum(extranjerosmujeres) total_mujeres_extranjeras, desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_2\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n-- el tiempo de ejecucion no tiene comparacion con HIVE, siendo Impala mucho mas reapido para las dos consultas\\n\\n-- 4.7. Hacer consultas de agregaci\\u00f3n (Max, Min, Avg, Count) tal cual el ejemplo anterior con las 3 tablas \\n-- (padron_txt_2, padron_parquet_2 y padron_particionado) y comparar rendimientos tanto en Hive como en Impala \\n-- y sacar conclusiones.\\n\\n\\n-- padron_txt_3\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n--padron_parquet_3\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n-- padron_particionada\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n-- tablas parquet y particionada mas rapidas que las txt, sin embargo tendria que hacer otras priuebas para saber\\n-- cual de estas ultimas es mas rapida.\", \"statusForButtons\": \"executed\", \"showLogs\": true, \"variableNames\": [], \"associatedDocumentUuid\": null, \"compatibilitySourcePlatform\": \"impala\", \"chartLimit\": null, \"progress\": 0, \"chartType\": \"bars\", \"isFetchingData\": false, \"name\": \"\", \"statementTypes\": [\"text\", \"file\"], \"is_redacted\": false, \"currentQueryTab\": \"queryResults\", \"chartScope\": \"world\", \"result\": {\"statement_id\": 0, \"isMetaFilterVisible\": false, \"meta\": [], \"logLines\": 1, \"id\": \"fdfba20e-9f79-9240-0456-140c110455ca\", \"logs\": \"\", \"statements_count\": 1, \"rows\": 35, \"hasSomeResults\": true, \"filteredMetaChecked\": true, \"hasMore\": false, \"filteredMeta\": [{\"comment\": null, \"checked\": true, \"name\": \"count(espanoleshombres)\", \"originalIndex\": 1, \"cssClass\": \"sort-numeric\", \"type\": \"BIGINT_TYPE\"}, {\"comment\": null, \"checked\": true, \"name\": \"count(espanolesmujeres)\", \"originalIndex\": 2, \"cssClass\": \"sort-numeric\", \"type\": \"BIGINT_TYPE\"}, {\"comment\": null, \"checked\": true, \"name\": \"count(extranjeroshombres)\", \"originalIndex\": 3, \"cssClass\": \"sort-numeric\", \"type\": \"BIGINT_TYPE\"}, {\"comment\": null, \"checked\": true, \"name\": \"count(extranjerosmujeres)\", \"originalIndex\": 4, \"cssClass\": \"sort-numeric\", \"type\": \"BIGINT_TYPE\"}, {\"comment\": null, \"checked\": true, \"name\": \"distrito\", \"originalIndex\": 5, \"cssClass\": \"sort-string\", \"type\": \"STRING_TYPE\"}, {\"comment\": null, \"checked\": true, \"name\": \"barrio\", \"originalIndex\": 6, \"cssClass\": \"sort-string\", \"type\": \"STRING_TYPE\"}], \"type\": \"table\", \"handle\": {\"log_context\": null, \"statements_count\": 1, \"end\": {\"column\": 339, \"row\": 0}, \"statement_id\": 0, \"has_more_statements\": false, \"start\": {\"column\": 0, \"row\": 0}, \"secret\": \"+TaOUrGAStIAAAAAnqKjtw==\\n\", \"has_result_set\": true, \"session_guid\": \"m9UNQwUZRmKgM+kOuxtjyQ==\\n\", \"statement\": \"select count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio\", \"operation_type\": 0, \"modified_row_count\": null, \"guid\": \"+TaOUrGAStIAAAAAnqKjtw==\\n\", \"previous_statement_hash\": \"f1823d3355e3381bae85dc55318fb4892c9abb66a15f5bbbceed0dee\"}, \"metaFilter\": \"\", \"explanation\": \"\", \"statement_range\": {\"start\": {\"column\": 0, \"row\": 0}, \"end\": {\"column\": 0, \"row\": 0}}, \"startTime\": \"2021-05-18T07:14:33.786Z\", \"data\": [], \"executionTime\": 0, \"fetchedOnce\": false, \"hasResultset\": true, \"endTime\": \"2021-05-18T07:14:33.786Z\"}, \"errors\": [], \"chartMapHeat\": null, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"aceErrorsHolder\": [], \"showOptimizer\": false, \"compatibilityTargetPlatform\": \"impala\", \"jobs\": [], \"statementType\": \"text\", \"variableValues\": {}, \"isCanceling\": false, \"queriesTotalPages\": 1, \"formatEnabled\": true, \"properties\": {\"settings\": []}, \"aceErrors\": [], \"externalStatementLoaded\": false, \"chartScatterSize\": null, \"chartYSingle\": null, \"suggestion\": \"\", \"statementPath\": \"\", \"showLongOperationWarning\": false, \"chartX\": \"distrito\", \"lastExecuted\": 1621322073765, \"variables\": [], \"showChart\": false, \"isResultSettingsVisible\": false, \"showGrid\": true, \"pinnedContextTabs\": [], \"viewSettings\": {\"sqlDialect\": true, \"placeHolder\": \"Example: SELECT * FROM tablename, or press CTRL + space\"}, \"statementsList\": [\"\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\n--padron_parquet_3\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\n-- padron_particionada\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\", \"\\n\\n-- tablas parquet y particionada mas rapidas que las txt, sin embargo tendria que hacer otras priuebas para saber\\n-- cual de estas ultimas es mas rapida.\"], \"lastAceSelectionRowOffset\": 175, \"executingBlockingOperation\": null, \"errorsKlass\": \"results impala alert alert-error\", \"statement\": \"-- 4.7. Hacer consultas de agregaci\\u00f3n (Max, Min, Avg, Count) tal cual el ejemplo anterior con las 3 tablas \\n-- (padron_txt_2, padron_parquet_2 y padron_particionado) y comparar rendimientos tanto en Hive como en Impala \\n-- y sacar conclusiones.\\n\\n\\n-- padron_txt_3\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_txt_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n--padron_parquet_3\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_parquet_3\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\n-- padron_particionada\\nselect max(espanoleshombres), max(espanolesmujeres), max(extranjeroshombres), max(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect min(espanoleshombres), min(espanolesmujeres), min(extranjeroshombres), min(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect avg(espanoleshombres), avg(espanolesmujeres),avg(extranjeroshombres), avg(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\\nselect count(espanoleshombres), count(espanolesmujeres),count(extranjeroshombres), count(extranjerosmujeres), desc_distrito distrito, desc_barrio barrio\\nfrom padron_particionada\\nwhere desc_distrito in (\\\"CENTRO\\\", \\\"LATINA\\\", \\\"CHAMARTIN\\\", \\\"TETUAN\\\", \\\"VICALVARO\\\", \\\"BARAJAS\\\")\\ngroup by desc_distrito, desc_barrio\\norder by desc_distrito, desc_barrio;\\n\", \"type\": \"impala\", \"chartSorting\": \"none\", \"previousChartOptions\": {\"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartLimit\": null, \"chartMapHeat\": null, \"chartX\": \"distrito\", \"chartMapType\": \"marker\", \"chartYMulti\": [\"avg(espanolesmujeres)\"], \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartMapLabel\": null, \"chartScatterGroup\": null, \"chartYSingle\": null, \"chartXPivot\": null}, \"aceWarningsHolder\": [], \"resultsKlass\": \"results impala\", \"chartTimelineType\": \"bar\", \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"topRisk\": null, \"hasCurlyBracketParameters\": true, \"chartScatterGroup\": null, \"settingsVisible\": false, \"queriesFilterVisible\": false, \"aceWarnings\": [], \"compatibilityCheckRunning\": false, \"isLoading\": false, \"loadingQueries\": false, \"hasDataForChart\": true, \"id\": \"10b7cd98-ff7b-35ca-8432-eb42b31ea70f\", \"aceSize\": 100, \"chartData\": [], \"queriesHasErrors\": false, \"chartMapLabel\": null, \"status\": \"available\", \"isSqlDialect\": true, \"chartMapType\": \"marker\", \"queriesFilter\": \"\", \"queriesCurrentPage\": 1, \"isBatchable\": true, \"chartYMulti\": [\"count(espanolesmujeres)\"], \"dbSelectionVisible\": false, \"database\": \"datos_padron\", \"hasSuggestion\": null, \"chartXPivot\": null, \"checkStatusTimeout\": null}], \"uuid\": \"8518a828-b44a-48f7-b319-10e3164a536e\", \"onSuccessUrl\": null, \"is_history\": false, \"historyFilterVisible\": false, \"retryModalConfirm\": null, \"selectedSnippet\": \"impala\", \"type\": \"query-impala\", \"historyFilter\": \"\", \"description\": \"\", \"sessions\": [{\"id\": 16, \"type\": \"impala\", \"properties\": [{\"multiple\": true, \"defaultValue\": [], \"value\": [], \"nice_name\": \"Settings\", \"key\": \"settings\", \"help_text\": \"Impala configuration properties.\", \"type\": \"settings\", \"options\": [\"debug_action\", \"explain_level\", \"mem_limit\", \"optimize_partition_key_scans\", \"query_timeout_s\", \"request_pool\"]}], \"http_addr\": \"http://quickstart.cloudera:25000\"}], \"updateHistoryFailed\": false, \"isSaved\": true, \"presentationSnippets\": {}, \"isBatchable\": true, \"isHistory\": false, \"coordinatorUuid\": null, \"name\": \"Padron_2_Impala\", \"isManaged\": false, \"loadingScheduler\": false, \"parentSavedQueryUuid\": \"c82223f2-b6aa-7cac-1958-f6b288712836\", \"viewSchedulerId\": \"\", \"historyCurrentPage\": 1, \"creatingSessionLocks\": [], \"directoryUuid\": \"\", \"unloaded\": false, \"dependentsCoordinator\": []}", 
    "is_trashed": false, 
    "name": "Padron_2_Impala"
  }
}
]
